# 03. å¼ºåº¦è®¡ç®—ç®—æ³•æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°
æœ¬æ–‡æ¡£æè¿°è‚¡ç¥¨å’Œæ¿å—å¼ºåº¦æŒ‡æ ‡çš„è®¡ç®—ç®—æ³•ã€‚

## ğŸ¯ å¼ºåº¦è¯„åˆ†ç³»ç»Ÿ

### å•ä¸ªå‡çº¿å‘¨æœŸè¯„åˆ†

#### æ–¹æ¡ˆä¸€ï¼šäºŒè¿›åˆ¶è¯„åˆ†ï¼ˆç®€å•ç‰ˆï¼‰
```python
def calculate_binary_score(current_price, ma_value):
    """
    äºŒè¿›åˆ¶è¯„åˆ†ï¼šä»·æ ¼åœ¨å‡çº¿ä¸Šæ–¹å¾—1åˆ†ï¼Œä¸‹æ–¹å¾—0åˆ†
    """
    return 1 if current_price > ma_value else 0
```

#### æ–¹æ¡ˆäºŒï¼šè·ç¦»æ¯”ä¾‹è¯„åˆ†ï¼ˆæ¨èï¼‰
```python
def calculate_distance_score(current_price, ma_value):
    """
    åŸºäºè·ç¦»æ¯”ä¾‹çš„è¯„åˆ†ç³»ç»Ÿï¼ˆ0-100åˆ†ï¼‰
    """
    position_ratio = (current_price - ma_value) / ma_value

    if position_ratio > 0.10:    # é«˜äºå‡çº¿10%ä»¥ä¸Š
        return 100
    elif position_ratio > 0.05:  # é«˜äºå‡çº¿5-10%
        return 90
    elif position_ratio > 0.02:  # é«˜äºå‡çº¿2-5%
        return 80
    elif position_ratio > 0:     # ç•¥é«˜äºå‡çº¿
        return 70
    elif position_ratio > -0.02: # ç•¥ä½äºå‡çº¿
        return 50
    elif position_ratio > -0.05: # ä½äºå‡çº¿2-5%
        return 30
    elif position_ratio > -0.10: # ä½äºå‡çº¿5-10%
        return 20
    else:                        # ä½äºå‡çº¿10%ä»¥ä¸Š
        return 10
```

#### æ–¹æ¡ˆä¸‰ï¼šè¿ç»­æ¯”ä¾‹è¯„åˆ†
```python
def calculate_continuous_score(current_price, ma_value):
    """
    è¿ç»­æ¯”ä¾‹è¯„åˆ†ç³»ç»Ÿ
    """
    position_ratio = (current_price - ma_value) / ma_value

    # å°†-20%åˆ°+20%çš„èŒƒå›´æ˜ å°„åˆ°0-100åˆ†
    normalized_score = max(0, min(100, 50 + (position_ratio * 250)))
    return round(normalized_score)
```

## ğŸ“Š ç»¼åˆå¼ºåº¦è®¡ç®—

### æƒé‡é…ç½®
æ¯ä¸ªå‡çº¿å‘¨æœŸå¯ä»¥é…ç½®ä¸åŒçš„æƒé‡ï¼š

| å‘¨æœŸ | æƒé‡ | è¯´æ˜ |
|------|------|------|
| 5æ—¥  | 1.0  | çŸ­æœŸè¶‹åŠ¿ |
| 10æ—¥ | 1.2  | çŸ­æœŸè¶‹åŠ¿ |
| 20æ—¥ | 1.5  | ä¸­æœŸè¶‹åŠ¿ |
| 30æ—¥ | 1.8  | ä¸­æœŸè¶‹åŠ¿ |
| 60æ—¥ | 2.0  | ä¸­é•¿æœŸè¶‹åŠ¿ |
| 120æ—¥| 2.2  | é•¿æœŸè¶‹åŠ¿ |
| 250æ—¥| 2.5  | é•¿æœŸè¶‹åŠ¿ |

### ç»¼åˆå¾—åˆ†è®¡ç®—
```python
def calculate_total_score(scores, weights):
    """
    è®¡ç®—åŠ æƒç»¼åˆå¾—åˆ†
    """
    weighted_sum = sum(score * weight for score, weight in zip(scores, weights))
    total_weight = sum(weights)
    return weighted_sum / total_weight
```

## ğŸ¢ æ¿å—å¼ºåº¦è®¡ç®—

### æ¿å—å¼ºåº¦èšåˆ
```python
def calculate_sector_strength(sector_stocks, trade_date):
    """
    è®¡ç®—æ¿å—ç»¼åˆå¼ºåº¦
    """
    sector_scores = []

    for stock in sector_stocks:
        # è·å–è¯¥è‚¡ç¥¨çš„ç»¼åˆå¼ºåº¦å¾—åˆ†
        stock_score = get_stock_total_score(stock.id, trade_date)
        sector_scores.append(stock_score)

    # è®¡ç®—æ¿å—å¹³å‡å¼ºåº¦ï¼ˆå¯è€ƒè™‘å¸‚å€¼åŠ æƒï¼‰
    return sum(sector_scores) / len(sector_scores)
```

### æ¿å—æ’åç®—æ³•
```python
def rank_sectors(sector_strengths):
    """
    å¯¹æ¿å—è¿›è¡Œå¼ºåº¦æ’å
    """
    # æŒ‰å¼ºåº¦å¾—åˆ†é™åºæ’åº
    sorted_sectors = sorted(sector_strengths.items(),
                           key=lambda x: x[1],
                           reverse=True)

    # åˆ†é…æ’åï¼ˆå¤„ç†å¹¶åˆ—æƒ…å†µï¼‰
    rankings = {}
    current_rank = 1
    prev_score = None

    for i, (sector, score) in enumerate(sorted_sectors):
        if prev_score is not None and score < prev_score:
            current_rank = i + 1
        rankings[sector] = current_rank
        prev_score = score

    return rankings
```

## ğŸ¨ å¯è§†åŒ–æ˜ å°„

### é¢œè‰²ç¼–ç ç³»ç»Ÿ
| å¾—åˆ†èŒƒå›´ | é¢œè‰²     | å«ä¹‰       |
|----------|----------|------------|
| 90-100   | ğŸŸ¢ æ·±ç»¿è‰² | éå¸¸å¼ºåŠ¿   |
| 70-89    | ğŸŸ© ç»¿è‰²   | å¼ºåŠ¿       |
| 50-69    | ğŸŸ¡ é»„è‰²   | ä¸­æ€§       |
| 30-49    | ğŸŸ  æ©™è‰²   | å¼±åŠ¿       |
| 0-29     | ğŸ”´ çº¢è‰²   | éå¸¸å¼±åŠ¿   |

### è¶‹åŠ¿æŒ‡ç¤ºå™¨
```python
def get_trend_indicator(current_score, previous_score):
    """
    ç”Ÿæˆè¶‹åŠ¿æŒ‡ç¤ºç®­å¤´
    """
    if current_score > previous_score + 5:
        return "â†‘"  # å¼ºåŠ¿ä¸Šå‡
    elif current_score > previous_score + 2:
        return "â†—"  # æ¸©å’Œä¸Šå‡
    elif abs(current_score - previous_score) <= 2:
        return "â†’"  # æŒå¹³
    elif current_score < previous_score - 2:
        return "â†˜"  # æ¸©å’Œä¸‹é™
    else:
        return "â†“"  # å¼ºåŠ¿ä¸‹é™
```

## ğŸ”§ é…ç½®çµæ´»æ€§

### åŠ¨æ€é…ç½®æ”¯æŒ
- å‡çº¿å‘¨æœŸå¯éšæ—¶æ·»åŠ /åˆ é™¤
- æƒé‡ç³»æ•°å¯åŠ¨æ€è°ƒæ•´
- è¯„åˆ†ç®—æ³•å¯åˆ‡æ¢
- é˜ˆå€¼å‚æ•°å¯é…ç½®

---
*æ–‡æ¡£ç‰ˆæœ¬: 1.0*
*æœ€åæ›´æ–°: 2024-01-20*